# Spring Framework - Вопросы и ответы

## Оглавление

1. [Что такое бин?](#что-такое-бин)
2. [Виды бинов](#виды-бинов)
3. [Чем бин отличается от POJO-класса?](#чем-бин-отличается-от-pojo-класса)
4. [Что такое Inversion of Control и как Spring реализует этот принцип?](#что-такое-inversion-of-control-и-как-spring-реализует-этот-принцип)
5. [Для чего существует такое количество ApplicationContext?](#для-чего-существует-такое-количество-applicationcontext)
6. [Как можно связать бины?](#как-можно-связать-бины)
7. [Что такое Dependency Injection?](#что-такое-dependency-injection)
8. [Какие бины будут использоваться для настройки приложения?](#какие-бины-будут-использоваться-для-настройки-приложения)
9. [Как получить данные из файла .property?](#как-получить-данные-из-файла-property)
10. [Как запустить Spring-приложение из-под сервера Tomcat?](#как-запустить-spring-приложение-из-под-сервера-tomcat)
11. [Что такое Artifacts?](#что-такое-artifacts)
12. [В чем отличие артефакта war от war exploded?](#в-чем-отличие-артефакта-war-от-war-exploded)
13. [Какая разница между аннотациями @Component, @Repository и @Service?](#какая-разница-между-аннотациями-component-repository-и-service)
14. [Как выглядит структура MVC-приложения?](#как-выглядит-структура-mvc-приложения)
15. [Чем контроллер отличается от сервлета?](#чем-контроллер-отличается-от-сервлета)
16. [Какая основная зависимость фреймворка Spring?](#какая-основная-зависимость-фреймворка-spring)
17. [Как вернуть страницу в контроллере? Как вернуть данные?](#как-вернуть-страницу-в-контроллере-как-вернуть-данные)
18. [Принципы работы Spring](#принципы-работы-spring)
19. [Связывание бинов и их жизненный цикл](#связывание-бинов-и-их-жизненный-цикл)
20. [Основные паттерны Spring](#основные-паттерны-spring)

---

## Что такое бин?

Бин в Spring — это объект, которым управляет IoC-контейнер Spring: он создает его, настраивает и хранит в контексте приложения. Такие объекты образуют «скелет» приложения, а их описание содержится в конфигурации (аннотации, Java-конфиг, XML).

## Виды бинов

Обычно под «видами бинов» имеют в виду области видимости (scopes): 
- **singleton** — один экземпляр на контекст
- **prototype** — новый экземпляр при каждом запросе
- **request** — один на HTTP-запрос
- **session** — один на сессию
- **application** — один на веб-приложение
- **websocket** — один на WebSocket-соединение

Чаще всего в обычных приложениях используются singleton и prototype.

## Чем бин отличается от POJO-класса?

POJO — это просто обычный Java-класс без зависимостей от фреймворков, а бин — экземпляр такого (или любого) класса, зарегистрированный и управляемый Spring-контейнером. Один и тот же POJO может быть бином, если Spring его создает и хранит в контексте, или «просто объектом», если он создается вручную через `new`.

## Что такое Inversion of Control и как Spring реализует этот принцип?

Inversion of Control (IoC) — это принцип, когда управление созданием и связыванием объектов передается фреймворку, а не пишется вручную в бизнес-коде. Spring реализует IoC через контейнер ApplicationContext, который сам создает бины и внедряет им зависимости.

## Для чего существует такое количество ApplicationContext?

Разные реализации ApplicationContext нужны для разных источников конфигурации и типов приложений:
- `AnnotationConfigApplicationContext` — для Java-конфигурации
- `ClassPathXmlApplicationContext` — для XML из classpath
- `FileSystemXmlApplicationContext` — для XML из файловой системы
- `WebApplicationContext` — для веб-приложений

## Как можно связать бины?

Бины связываются через внедрение зависимостей:
1. **По конструктору** — через параметры конструктора
2. **Через сеттеры** — через методы set*
3. **Через поля** — с помощью аннотаций @Autowired, @Inject
4. **Явное описание** — в Java-конфигурации (@Bean-методы) или в XML-конфигурации

## Что такое Dependency Injection?

Dependency Injection (DI) — это способ реализовать IoC, когда зависимости объекта передаются ему «снаружи», а не создаются им самим. В Spring DI выполняет IoC-контейнер: он находит нужные бины и подставляет их в конструктор, сеттеры или поля других бинов.

## Какие бины будут использоваться для настройки приложения?

Для настройки часто используются конфигурационные бины:
- Классы с аннотацией `@Configuration` и методами `@Bean`
- Инфраструктурные бины (DataSource, EntityManagerFactory, TransactionManager и т.п.)
- В более старых проектах те же настройки могли быть описаны как `<bean>` в XML

## Как получить данные из файла .property?

Обычно используют файлы `application.properties` / `application.yml` и доступ к ним:
- Через аннотацию `@Value("${key}")`
- Через бин `Environment`
- В Spring Boot можно подключать дополнительные property-файлы с помощью `@PropertySource` в конфигурационном классе

## Как запустить Spring-приложение из-под сервера Tomcat?

Классическое Spring MVC-приложение упаковывается в war и деплоится на внешний Tomcat, который поднимает web-приложение и инициализирует Spring-контекст через DispatcherServlet. 

В Spring Boot можно:
1. Собрать war-артефакт (packaging war)
2. Включить класс SpringBootServletInitializer
3. Задеплоить на внешний Tomcat

## Что такое Artifacts?

В контексте Maven/IDEA артефакт — это собранный результат проекта: jar, war и т.п., который можно запускать или деплоить на сервер. Конфигурация артефакта описывает, какие классы и ресурсы войдут внутрь и как он будет упакован.

## В чем отличие артефакта war от war exploded?

- **war** — это единый архив (один файл), готовый к деплою на сервер приложений
- **war exploded** — это уже развернутая структура каталогов (WEB-INF, классы, ресурсы), удобная для горячего деплоя и быстрой разработки

## Какая разница между аннотациями @Component, @Repository и @Service?

- `@Component` — базовая аннотация для любого компонента, который должен стать бином и попасть в контекст
- `@Service` — специализированный вариант @Component для сервисного слоя
- `@Repository` — специализированный вариант @Component для слоя доступа к данным (добавляет перевод исключений в DataAccessException)

## Как выглядит структура MVC-приложения?

Spring MVC делит приложение на слои:
- **Model** — сущности, DTO, сервисы, репозитории
- **View** — шаблоны HTML/Thymeleaf/JSP
- **Controller** — обрабатывает HTTP-запросы и выбирает представление

Поток:
1. Пользователь делает запрос
2. Запрос попадает в DispatcherServlet
3. Тот выбирает контроллер
4. Контроллер вызывает сервисы/репозитории
5. Возвращает модель и имя view

## Чем контроллер отличается от сервлета?

- **Servlet** — это низкоуровневый компонент сервлет-контейнера, который напрямую работает с HttpServletRequest/Response
- **Spring-контроллер** — обычный бин, над которым «сидит» DispatcherServlet: он маршрутизирует запросы и вызывает методы контроллера, а сам контроллер уже не является сервлетом

## Какая основная зависимость фреймворка Spring?

Раньше основной модуль был `spring-core` и связанные с ним `spring-context` и пр. 
Сейчас чаще используют стартеры Spring Boot, например `spring-boot-starter-web`. 

Во многих билд-файлах отдельно не указывают каждую зависимость Spring, потому что стартеры подключают нужные модули транзитивно.

## Как вернуть страницу в контроллере? Как вернуть данные?

**В классическом Spring MVC:**
- Метод контроллера возвращает строку — имя view (шаблона)
- Модель передается через Model/ModelMap/ModelAndView

**В REST-контроллере (@RestController):**
- Метод возвращает данные (объект/список)
- Они автоматически сериализуются в JSON
- Отправляются в ответе

## Принципы работы Spring

Spring основан на IoC/DI: контейнер управляет созданием бинов, их жизненным циклом и связями. Вокруг этого строится инфраструктура:
- **AOP** — аспектно-ориентированное программирование
- **Декларативные транзакции** — управление транзакциями через аннотации
- **Обработка запросов в MVC** — маршрутизация и обработка HTTP-запросов
- **Автоконфигурация в Spring Boot** — автоматическая настройка компонентов

## Связывание бинов и их жизненный цикл

**Связывание бинов** происходит при создании контекста:
1. Контейнер сканирует конфигурацию
2. Создает бины
3. Внедряет зависимости

**Жизненный цикл** включает:
1. **Создание** экземпляра
2. **Заполнение** зависимостей
3. **Вызов callback-методов** (например, @PostConstruct)
4. **Использование** бина
5. **Уничтожение** (для singleton — при закрытии контекста)

## Основные паттерны Spring

Spring активно использует паттерны:
- **Inversion of Control/Dependency Injection** — управление созданием объектов
- **Factory Method** — создание бинов
- **Singleton** — scope singleton
- **Proxy** — AOP, транзакции
- **Template Method** — JdbcTemplate и др.
- **Front Controller** — DispatcherServlet маршрутизирует все запросы к контроллерам

---

**Дата создания:** 2025-12-15
